<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: sans-serif;
      max-width: 700px;
      margin: auto;
      padding: 2rem;
    }
    h2 {
      text-align: center;
      margin-bottom: 1.5rem;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      padding: 0.75rem;
      border: 1px solid #ccc;
      text-align: center;
    }
    th {
      background-color: #f0f0f0;
    }
    .highlight {
      background-color: #d1f7d1; /* ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏≠‡πà‡∏≠‡∏ô */
      font-weight: bold;
    }
    .loading {
      text-align: center;
      font-style: italic;
      color: gray;
    }
  </style>
</head>
<body>

  <h2>üìÖ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á</h2>

  <div id="bookingArea">
    <p class="loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
  </div>

  <script>
    // üîß Mock ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‚Äî ‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Power Automate
    const mockData = [
      { ‡∏ä‡∏∑‡πà‡∏≠: "‡∏™‡∏°‡∏ä‡∏≤‡∏¢", ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: "2025-07-22", ‡πÄ‡∏ß‡∏•‡∏≤: "09:00 - 10:00" },
      { ‡∏ä‡∏∑‡πà‡∏≠: "‡∏≠‡∏£‡∏ó‡∏±‡∏¢", ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: "2025-07-22", ‡πÄ‡∏ß‡∏•‡∏≤: "13:00 - 14:00" },
      { ‡∏ä‡∏∑‡πà‡∏≠: "‡∏ì‡∏±‡∏ê‡∏ß‡∏∏‡∏í‡∏¥", ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: "2025-07-22", ‡πÄ‡∏ß‡∏•‡∏≤: "15:00 - 16:00" }
    ];

    // ‡πÅ‡∏õ‡∏•‡∏á‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤ ‡πÄ‡∏ä‡πà‡∏ô "13:00 - 14:00" ‚Üí ‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏≤‡∏ó‡∏µ
    function parseTimeRange(timeStr) {
      const [start, end] = timeStr.split(" - ");
      const toMinutes = t => {
        const [h, m] = t.split(":").map(Number);
        return h * 60 + m;
      };
      return [toMinutes(start), toMinutes(end)];
    }

    // ‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà YYYY-MM-DD ‡πÅ‡∏•‡∏∞‡∏ô‡∏≤‡∏ó‡∏µ ‡∏ì ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ)
    function getNowDateTime() {
      const now = new Date();
      const pad = n => String(n).padStart(2, '0');
      const today = `${now.getFullYear()}-${pad(now.getMonth()+1)}-${pad(now.getDate())}`;
      const nowMinutes = now.getHours() * 60 + now.getMinutes();
      return { today, nowMinutes };
    }

    // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á
    function renderTable(data) {
      const { today, nowMinutes } = getNowDateTime();
      let table = `
        <table>
          <thead>
            <tr>
              <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á</th>
              <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
              <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
            </tr>
          </thead>
          <tbody>
      `;

      data.forEach(item => {
        const [startMin, endMin] = parseTimeRange(item.‡πÄ‡∏ß‡∏•‡∏≤);
        const isToday = item.‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà === today;
        const isNow = isToday && nowMinutes >= startMin && nowMinutes <= endMin;

        table += `
          <tr class="${isNow ? 'highlight' : ''}">
            <td>${item.‡∏ä‡∏∑‡πà‡∏≠}</td>
            <td>${item.‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà}</td>
            <td>${item.‡πÄ‡∏ß‡∏•‡∏≤}</td>
          </tr>
        `;
      });

      table += "</tbody></table>";
      document.getElementById("bookingArea").innerHTML = table;
    }

    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤ ‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏∏‡∏Å 30 ‡∏ß‡∏¥
    document.addEventListener("DOMContentLoaded", () => {
      renderTable(mockData); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å

      setInterval(() => {
        renderTable(mockData); // ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏ó‡∏∏‡∏Å 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
      }, 30000);
    });
  </script>

</body>
</html>
